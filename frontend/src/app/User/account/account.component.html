<!-- <p>account works!</p> -->

<div class="container py-4">
    <div class="row py-2">
        <div class="col-lg-4">
            <div class="card mb-1 border-0 p-1" style="background-color:rgb(242, 248, 238);">
                <h3 class="text-muted"><i><span class="text-success">Hey</span> {{ User?.userFullName }}</i></h3>
                <p class="text-primary">Prime Member</p>
            </div>
            <div class="personal-info mt-3">
                <h6>Personal Information</h6>
                <ul class="submenu">
                    <li (click)="selectSection('Personal-info')">Personal Information</li>
                </ul>
            </div>
            <div class="orders">
                <h6>My Orders</h6>
                <ul class="submenu">
                    <li (click)="selectSection('orders')">Orders</li>
                </ul>
            </div>
            <div class="account-settings">
                <h6>Account Settings</h6>
                <ul class="submenu">
                    <li (click)="selectSection('manage-address')">Manage Addresses</li>
                </ul>
            </div>
            <div class="payment-section">
                <h6>Payment</h6>
                <ul class="submenu">
                    <li (click)="selectSection('payment')">Saved Cards</li>
                    <li (click)="selectSection('payment')">Saved UPIs</li>
                </ul>
            </div>
            <div class="payment-section">
                <h6>Payment</h6>
                <ul class="submenu">
                    <li (click)="selectSection('payment')">Saved Cards</li>
                    <li (click)="selectSection('payment')">Saved UPIs</li>
                </ul>
            </div>
            <hr>
            <h5 class="text-primary">Logout</h5>  
        </div>
        <div class="col-lg-8">
            <ng-container *ngIf="activeSection === 'Personal-info' || activeSection === ''">
                <div class="row">
                    <div class="col-md-10">
                        <h2>Personal Information <span class="text-primary" style="font-size: medium;"><a href="#"
                                    (click)="editPersonalInfo()">edit</a></span></h2>
                    </div>
                    <div class="col-md-2">
                        <img src="../../assets/user.png" alt="Profile Picture" class="img-thumbnail" width="100" />
                    </div>   
                </div>
                <form>
                    <div class="mb-3">
                        <label for="name" class="form-label">Name</label>
                        <input type="text" id="name" class="form-control" [value]=" User?.userFullName" disabled />
                    </div>
    
                    <div class="mb-3">
                        <label for="mobile" class="form-label">Mobile Number</label>
                        <input type="text" id="mobile" class="form-control" [value]="User.mobile" disabled />
                    </div>
    
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" id="email" class="form-control" [value]="User.email" disabled />
                    </div>
    
                    <div class="mb-3">
                        <label for="address" class="form-label">Address</label>
                        <textarea id="address" class="form-control" [value]="User.userProfileWithAddresses.shippingAddress + ', ' + User.userProfileWithAddresses.city + ', ' + User.userProfileWithAddresses.state + ' - ' + User.userProfileWithAddresses.zipCode" disabled></textarea>
                    </div>
    
                    <div class="mb-3">
                        <label for="pan" class="form-label">PAN Number</label>
                        <input type="text" id="pan" class="form-control" [value]="User.pan" disabled />
                    </div>
                </form>
            </ng-container>
        
            <ng-container *ngIf="activeSection === 'orders'">
                <h3>My Orders</h3>
                <!-- <ul>
                    <li *ngFor="let order of User.userOrders">
                        Order ID: {{ order.id }} | Total: ${{ order.total }} | Status: {{ order.status }} | Date: {{
                        order.date }}
                    </li>
                </ul> -->
                <div class="container mt-4">
                    <!-- <h3>My Orders</h3> -->
                    <div class="row">
                      <div class="col-md-6">
                        <ul class="list-group">
                          <li *ngFor="let order of User.userOrders" (click)="selectOrder(order)" class="list-group-item d-flex justify-content-between align-items-start">
                            <div class="me-2">
                              <img src="{{ order.imageUrl }}" alt="{{ order.name }}" class="img-thumbnail" width="100">
                            </div>
                            <div class="w-100">
                              <div class="d-flex justify-content-between align-items-start">
                                <h5 class="mb-1">{{ order.name }}</h5>
                                <span class="badge bg-secondary">{{ order.orderStatus }}</span>
                              </div>
                              <p class="mb-1">Order ID: {{ order.id }} | Total: ${{ order.totalAmount }}</p>
                              <div>
                                <button class="btn btn-danger btn-sm" (click)="cancelOrder(order)">Cancel</button>
                                <button class="btn btn-warning btn-sm" (click)="returnOrder(order)">Return</button>
                              </div>
                            </div>
                          </li>
                        </ul>
                      </div>
                      <!-- <div class="col-md-6">
                        <app-order-detail [order]="selectedOrder"></app-order-detail>
                      </div> -->
                    </div>
                  </div>
                  
            </ng-container>
        
            <ng-container *ngIf="activeSection === 'manage-address'">
                <h2 class="mb-4 orderh3">Manage Addresses</h2>
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-md-12">
                            <div *ngFor="let address of User.userProfileWithAddresses.addresses" class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <span *ngIf="address.isDefault; else showRecipientName">
                                            {{ User.userFullName }} - {{ address.recipientContactNo }}
                                        </span>
                                        <ng-template #showRecipientName>
                                            {{ address.recipientName }} - {{ address.recipientContactNo }}
                                        </ng-template>
                                    </h6><br />
                                    <p class="card-text">
                                        {{ address.addressLine1 }}
                                        {{ address.addressLine2 }}
                                        {{ address.landmark }}<br />
                                        {{ address.city }} - {{ address.state }} - {{ address.zipCode }} 
                                    </p>
                                    <div class="text-end mt-3">
                                        <button class="btn btn-primary" (click)="openModal(address)">Update Address</button>
                                    </div>
                                </div>
                            </div>
                
                            <!-- Update Address Modal -->
                            <div class="modal fade" id="updateAddressModal" tabindex="-1" aria-labelledby="updateAddressModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="updateAddressModalLabel">Update Address</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <form>
                                                <div class="mb-3">
                                                    <label for="addressLine1" class="form-label">Address Line 1</label>
                                                    <input type="text" class="form-control" id="addressLine1" 
                                                           [(ngModel)]="selectedAddress.addressLine1" name="addressLine1" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="addressLine2" class="form-label">Address Line 2</label>
                                                    <input type="text" class="form-control" id="addressLine2" 
                                                           [(ngModel)]="selectedAddress.addressLine2" name="addressLine2">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="landmark" class="form-label">Landmark</label>
                                                    <input type="text" class="form-control" id="landmark" 
                                                           [(ngModel)]="selectedAddress.landmark" name="landmark">
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-4">
                                                        <label for="city" class="form-label">City</label>
                                                        <input type="text" class="form-control" id="city" 
                                                               [(ngModel)]="selectedAddress.city" name="city" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="state" class="form-label">State</label>
                                                        <input type="text" class="form-control" id="state" 
                                                               [(ngModel)]="selectedAddress.state" name="state" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="zipCode" class="form-label">Zip Code</label>
                                                        <input type="text" class="form-control" id="zipCode" 
                                                               [(ngModel)]="selectedAddress.zipCode" name="zipCode" required>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                            <button type="button" class="btn btn-primary" (click)="saveAddress()">Save
                                                changes</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-container>
        
            <ng-container *ngIf="activeSection === 'payment'">
                <h3>Payment Methods</h3>
                <ul>
                    <li *ngFor="let payment of User.paymentMethods">
                        {{ payment.cardType }} ending in {{ payment.lastFourDigits }} (expires: {{ payment.expirationDate
                        }})
                    </li>
                </ul>
            </ng-container>
        </div>
    </div> 
</div>

